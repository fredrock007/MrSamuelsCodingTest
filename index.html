<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Disa Moodle Style Quiz ‚Ä¢ 100 Questions</title><style>:root{--bg:#f5f6f8;--surface:#fff;--text:#1f2937;--muted:#6b7280;--border:#dfe3ea;--brand:#b11226;--brand-2:#8f0e1e;--ok:#1b7f3b;--bad:#b42318;--warn:#b45309;--shadow:0 10px 28px rgba(17,24,39,.10);--radius:14px;--mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}*{box-sizing:border-box}body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:var(--bg);color:var(--text);line-height:1.4}.topbar{background:linear-gradient(180deg,var(--brand) 0%,var(--brand-2) 100%);color:#fff;padding:16px 18px;position:sticky;top:0;z-index:20;box-shadow:0 6px 18px rgba(0,0,0,.18)}.topbar-inner{max-width:1100px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;gap:14px}.brand{display:flex;align-items:center;gap:10px;min-width:0}.logo{height:140px;width:auto;display:block;object-fit:contain;filter:drop-shadow(0 8px 18px rgba(0,0,0,.25));}.brand h1{font-size:22px;margin:0;font-weight:1000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;letter-spacing:.2px}.brand .sub{font-size:13px;color:rgba(255,255,255,.88);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.timer-wrap{display:flex;flex-direction:column;align-items:flex-end;gap:6px}.timer-pill{display:flex;align-items:center;gap:10px;padding:10px 12px;border:1px solid rgba(255,255,255,.30);background:rgba(255,255,255,.14);border-radius:999px;font-weight:950;white-space:nowrap;backdrop-filter:blur(6px)}.timer-pill .label{font-weight:850;color:rgba(255,255,255,.90);font-size:12px}.timer-pill .time{font-family:var(--mono);font-size:15px;color:#fff}.timer-pill.warn{background:rgba(255,255,255,.18);border-color:rgba(255,255,255,.38)}.timer-pill.danger{background:rgba(255,255,255,.22);border-color:rgba(255,255,255,.50)}.credits{font-size:11px;color:rgba(255,255,255,.86)}.wrap{max-width:1100px;margin:18px auto 64px;padding:0 14px;display:grid;grid-template-columns:320px 1fr;gap:14px}@media (max-width:980px){.wrap{grid-template-columns:1fr}}.side{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;position:sticky;top:86px;align-self:start}@media (max-width:980px){.side{position:static}}.side-head{padding:14px 14px 10px;border-bottom:1px solid var(--border);background:#fbfcfe}.side-title{margin:0;font-size:14px;font-weight:1000}.side-sub{margin:6px 0 0;font-size:12px;color:var(--muted)}.ident{padding:12px 14px;border-bottom:1px solid var(--border);display:grid;gap:10px}.field label{font-size:12px;color:var(--muted);display:block;margin:0 0 6px}.field input{width:100%;padding:10px;border-radius:12px;border:1px solid var(--border);outline:none;background:#fff;font-size:14px}.field input:focus{border-color:rgba(15,108,191,.45);box-shadow:0 0 0 4px rgba(15,108,191,.12)}.nav{padding:12px 14px 14px}.legend{display:flex;gap:10px;align-items:center;flex-wrap:wrap;font-size:12px;color:var(--muted);margin-bottom:10px}.dot{width:10px;height:10px;border-radius:999px;display:inline-block}.dot.todo{background:#cbd5e1}.dot.done{background:var(--ok)}.dot.flag{background:var(--warn)}.grid{display:grid;grid-template-columns:repeat(6,1fr);gap:8px}.qbtn{border:1px solid var(--border);background:#fff;border-radius:12px;padding:8px 0;font-weight:1000;cursor:pointer;transition:transform .03s ease}.qbtn:active{transform:scale(.99)}.qbtn.done{border-color:rgba(27,127,59,.35);background:rgba(27,127,59,.06);color:var(--ok)}.qbtn.flag{border-color:rgba(180,83,9,.35);background:rgba(180,83,9,.08);color:var(--warn)}.qbtn.current{outline:3px solid rgba(15,108,191,.18);border-color:rgba(15,108,191,.45)}.side-actions{padding:12px 14px 14px;border-top:1px solid var(--border);display:flex;gap:10px;flex-wrap:wrap;background:#fbfcfe}.main{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}.main-head{padding:16px 18px;border-bottom:1px solid var(--border);background:#fbfcfe}.main-title{margin:0;font-size:18px;font-weight:1000}.main-sub{margin:6px 0 0;font-size:13px;color:var(--muted)}.panel{padding:14px 18px 18px}.qcard{border:1px solid var(--border);border-radius:var(--radius);overflow:hidden;background:#fff}.qhead{padding:14px 14px 10px;display:flex;justify-content:space-between;gap:10px;align-items:flex-start;background:#fafcff;border-bottom:1px solid var(--border)}.qnum{font-weight:1000;color:#0b2d4c}.qpts{font-size:12px;color:var(--muted);white-space:nowrap;margin-top:2px}.qtext{font-weight:850;margin-top:6px}.qbody{padding:10px 14px 14px}.opt{display:flex;gap:10px;padding:10px;border-radius:12px;cursor:pointer}.opt:hover{background:#f1f7ff}.opt input{margin-top:3px}.opt span{flex:1}.tools{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;margin-top:12px;align-items:center}button{border:0;border-radius:12px;padding:10px 12px;font-weight:1000;cursor:pointer;font-size:14px}.primary{background:var(--brand);color:#fff}.primary:hover{filter:brightness(.96)}.ghost{background:#fff;border:1px solid var(--border);color:var(--text)}.ghost:hover{background:#fafafa}.danger{background:#fff;border:1px solid rgba(180,35,24,.25);color:var(--bad)}.danger:hover{background:#fff5f5}.small{font-size:12px;color:var(--muted)}.flagbtn{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);background:#fff;padding:10px 12px;border-radius:12px;font-weight:1000;cursor:pointer}.flagbtn.flagged{border-color:rgba(180,83,9,.35);background:rgba(180,83,9,.08);color:var(--warn)}.result{margin-top:14px;border:1px solid var(--border);border-radius:var(--radius);padding:14px;background:#fbfcff}.score{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;align-items:center}.score .big{font-size:20px;font-weight:1000}.badge{display:inline-flex;align-items:center;padding:6px 10px;border-radius:999px;font-weight:1000;font-size:12px;border:1px solid var(--border);background:#fff}.badge.ok{color:var(--ok);border-color:rgba(27,127,59,.25);background:rgba(27,127,59,.06)}.badge.bad{color:var(--bad);border-color:rgba(180,35,24,.25);background:rgba(180,35,24,.06)}details.review{margin-top:12px}details.review summary{cursor:pointer;font-weight:1000;color:#0b2d4c}.review-list{margin:10px 0 0;padding-left:18px}.review-list li{margin:10px 0}.correct{color:var(--ok);font-weight:1000}.wrong{color:var(--bad);font-weight:1000}@media print{.topbar,.side,.tools,.flagbtn,#toastLayer,.fxOverlay{display:none!important}body{background:#fff}.wrap{grid-template-columns:1fr}.main{box-shadow:none}}/* ----- Toast + FX ----- */#toastLayer{position:fixed;inset:0;pointer-events:none;z-index:9999}#toastBox{position:absolute;left:50%;top:14px;transform:translateX(-50%);width:min(560px,calc(100% - 28px));pointer-events:none}.toast{pointer-events:auto;background:rgba(255,255,255,.96);border:1px solid rgba(223,227,234,.95);box-shadow:0 18px 46px rgba(17,24,39,.18);border-radius:18px;padding:14px 16px;display:flex;gap:12px;align-items:flex-start;backdrop-filter:blur(8px)}.toast .tTitle{font-weight:1000;font-size:15px;margin:0;color:#0b2d4c}.toast .tMeta{margin:4px 0 0;font-size:13px;color:var(--muted)}.toast .tScore{font-family:var(--mono);font-weight:1000;font-size:14px;color:#0b2d4c;margin-top:8px}.toast .pill{display:inline-flex;align-items:center;gap:8px;padding:7px 10px;border-radius:999px;font-weight:1000;font-size:12px;border:1px solid var(--border);background:#fff}.toast .pill.ok{color:var(--ok);border-color:rgba(27,127,59,.25);background:rgba(27,127,59,.06)}.toast .pill.bad{color:var(--bad);border-color:rgba(180,35,24,.25);background:rgba(180,35,24,.06)}.toast .emoji{width:40px;height:40px;border-radius:14px;display:grid;place-items:center;background:linear-gradient(180deg,rgba(177,18,38,.12),rgba(143,14,30,.06));border:1px solid rgba(177,18,38,.18);font-size:20px}.toast-enter{animation:toastIn .25s ease-out both}@keyframes toastIn{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}.toast-blur-exit{animation:toastBlurOut .35s ease-in both}@keyframes toastBlurOut{0%{opacity:1;filter:blur(0);transform:translateY(0)}100%{opacity:0;filter:blur(8px);transform:translateY(-12px)}}.confettiLayer{position:fixed;inset:0;pointer-events:none;overflow:hidden;z-index:9998}.confettiPiece{position:absolute;top:-14px;width:10px;height:16px;border-radius:3px;opacity:.95;transform:translateY(0) rotate(0deg);animation:confettiFall var(--dur) linear var(--delay) both}@keyframes confettiFall{0%{transform:translateY(-20px) rotate(0deg)}100%{transform:translateY(110vh) rotate(720deg)}}.fxOverlay{position:fixed;inset:0;display:none;pointer-events:none;z-index:10000;background:radial-gradient(1200px 800px at 50% 20%,rgba(255,255,255,.12),rgba(0,0,0,.62))}.fxOverlay.show{display:block;animation:fxIn .25s ease-out both}@keyframes fxIn{from{opacity:0}to{opacity:1}}#fxCanvas{position:absolute;inset:0;width:100%;height:100%}.congrats{position:absolute;left:50%;top:58%;transform:translate(-50%,-50%);text-align:center;font-weight:1000;letter-spacing:.5px;line-height:1}.congrats .big{font-size:min(88px,12vw);background:linear-gradient(180deg,#ffeaa0 0%,#ffd24a 50%,#c99200 100%);-webkit-background-clip:text;background-clip:text;color:transparent;text-shadow:0 16px 44px rgba(0,0,0,.35)}.congrats.rise{animation:rise 10s ease-out both}@keyframes rise{0%{opacity:0;transform:translate(-50%,-40%)}15%{opacity:1}100%{opacity:1;transform:translate(-50%,-64%)}}</style></head><body><header class="topbar"><div class="topbar-inner"><div class="brand"><img class="logo" src="disa-logo.png" alt="Disa Primary School Logo"><div style="min-width:0"><h1 id="courseTitle">Course: Coding &amp; Robotics</h1><div class="sub" id="quizTitle">Quiz: (100 Questions)</div></div></div><div class="timer-wrap"><div class="timer-pill" id="timerPill" title="Timer counts down. Auto-submits at 0."><span class="label">Time left</span><span class="time" id="timer">35:00</span></div><div class="credits">¬© MR SAMUELS</div></div></div></header><main class="wrap"><aside class="side" aria-label="Quiz navigation"><div class="side-head"><p class="side-title">Quiz navigation</p><p class="side-sub">Total: <strong>100</strong> questions ‚Ä¢ Auto-submit at 0</p></div><div class="ident">
  <div class="field">
    <label for="classSelect">Class</label>
    <select id="classSelect" style="width:100%;padding:10px;border-radius:12px;border:1px solid var(--border);background:#fff;font-size:14px">
      <option value="">Select class‚Ä¶</option>
    </select>
  </div>

  <div class="field">
    <label for="learnerSelect">Learner</label>
    <select id="learnerSelect" style="width:100%;padding:10px;border-radius:12px;border:1px solid var(--border);background:#fff;font-size:14px" disabled>
      <option value="">Select learner‚Ä¶</option>
    </select>
    <div class="small" id="gradeInfo" style="margin-top:6px">Grade: <strong>‚Äî</strong></div>
  </div>

  <div class="field">
    <label for="learnerName">Learner name</label>
    <input id="learnerName" autocomplete="name" placeholder="e.g., A. Smith"/>
  </div>
  <div class="field">
    <label for="className">Class</label>
    <input id="className" autocomplete="off" placeholder="e.g., 7B"/>
  </div>
</div><div class="nav"><div class="legend"><span><span class="dot todo"></span> Not answered</span><span><span class="dot done"></span> Answered</span><span><span class="dot flag"></span> Flagged</span></div><div class="grid" id="navGrid" aria-label="Question grid"></div></div><div class="side-actions"><button class="ghost" id="saveBtn" title="Save progress on this device.">Save</button><button class="danger" id="resetBtn" title="Reset attempt (clears this device only).">Reset</button></div></aside><section class="main"><div class="main-head"><p class="main-title" id="mainTitle">Attempt: Coding &amp; Robotics MCQ (100 Questions)</p><p class="main-sub" id="mainSub">Rules: Silent work. No talking. Auto-submit when time runs out.</p></div><div class="panel"><div class="qcard" id="qcard"></div><div class="tools"><div style="display:flex;gap:10px;flex-wrap:wrap"><button class="ghost" id="prevBtn" title="Go to the previous question.">Previous</button><button class="ghost" id="nextBtn" title="Go to the next question.">Next</button><button class="flagbtn" id="flagBtn" title="Flag this question to review later.">‚öë Flag question</button></div><div style="display:flex;gap:10px;flex-wrap:wrap"><button class="ghost" id="finishAttemptBtn" title="Shows unanswered/flagged summary (does not submit).">Finish attempt</button><button class="primary" id="submitBtn" title="Submit your answers and finish the quiz.">Submit all and finish</button></div></div><div class="result" id="result" style="display:none"></div></div></section></main><div id="toastLayer" aria-live="polite" aria-atomic="true"><div id="toastBox"></div></div><div class="confettiLayer" id="confettiLayer"></div><div class="fxOverlay" id="fxOverlay" aria-hidden="true"><canvas id="fxCanvas"></canvas><div class="congrats" id="congrats"><div class="big">Congratulations!</div></div></div><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script>(function(){"use strict";
// ---- Supabase (anon/public key only) ----
const SUPABASE_URL = "https://tcofqcoeqptjdjawgohb.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_3ud-FlpJ9AZZDIzVkZ1EoA_B7c-Vs7B";
let supabaseClient = null;
let learnerRows = []; // cached

function loadSupabase(){
  // loaded from CDN (see script tag near end)
  if(window.supabase && !supabaseClient){
    supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  }
}

async function fetchLearners(){
  if(!supabaseClient) return [];
  // Cache on device for speed
  const cacheKey = "disa_learners_cache_v1";
  const cached = localStorage.getItem(cacheKey);
  if(cached){
    try{
      const d = JSON.parse(cached);
      if(d && Array.isArray(d.rows) && (Date.now()-d.t) < 1000*60*60){ // 1 hour
        return d.rows;
      }
    }catch(e){}
  }

  const { data, error } = await supabaseClient
    .from("learners")
    .select("id, first_name, surname, full_name, class_name, grade, learner_code")
    .order("class_name", { ascending: true })
    .order("surname", { ascending: true });

  if(error){
    console.error("Supabase learners fetch error:", error);
    return [];
  }

  localStorage.setItem(cacheKey, JSON.stringify({ t: Date.now(), rows: data }));
  return data || [];
}

function uniq(arr){ return Array.from(new Set(arr)).filter(Boolean); }
function sortClass(a,b){ return String(a).localeCompare(String(b), undefined, { numeric:true, sensitivity:"base" }); }
function labelLearner(r){
  const fn = (r.first_name||"").trim();
  const sn = (r.surname||"").trim();
  const nm = (r.full_name||`${fn} ${sn}`).trim();
  const code = (r.learner_code||"").trim();
  return `${nm}${code?` (${code})`:``}`;
}

function populateSelectors(rows){
  const classSel = document.getElementById("classSelect");
  const learnerSel = document.getElementById("learnerSelect");
  if(!classSel || !learnerSel) return;

  const classes = uniq(rows.map(r=>r.class_name)).sort(sortClass);
  classSel.innerHTML = `<option value="">Select class‚Ä¶</option>` + classes.map(c=>`<option value="${esc(c)}">${esc(c)}</option>`).join("");

  classSel.addEventListener("change", ()=>{
    const cls = classSel.value;
    const filtered = rows.filter(r=>String(r.class_name)===String(cls));
    learnerSel.disabled = !cls;
    learnerSel.innerHTML = `<option value="">Select learner‚Ä¶</option>` + filtered.map(r=>`<option value="${esc(r.id)}">${esc(labelLearner(r))}</option>`).join("");
    document.getElementById("gradeInfo").innerHTML = `Grade: <strong>‚Äî</strong>`;
  });

  learnerSel.addEventListener("change", ()=>{
    const id = learnerSel.value;
    const r = rows.find(x=>String(x.id)===String(id));
    if(!r) return;
    applyLearner(r);
  });
}

function applyLearner(r){
  const name = (r.first_name||"").trim();
  const sn = (r.surname||"").trim();
  const full = (r.full_name || `${name} ${sn}`).trim();
  const cls = String(r.class_name||"").trim();
  const grade = (r.grade!=null? r.grade : "‚Äî");

  document.getElementById("learnerName").value = full;
  document.getElementById("className").value = cls;
  document.getElementById("gradeInfo").innerHTML = `Grade: <strong>${esc(String(grade))}</strong>`;

  // Fresh attempt for the selected learner (timer starts once name/class is present)
  // Restore original questions before reshuffling to avoid cumulative shuffles.
  S.seed = null;
  S.A = {}; S.F = {}; S.c = 0;
  S.r = QZ.durationMinutes*60;
  S.L = false;
  stop();

  restoreQuestions();
  shuffleOptionsDeterministic();
  nav();
  ren();
  navUI();
  tUI();
  save({ picked: 1, picked_at: Date.now(), learner_id: r.id });
  start();
}


// -------------------- Supabase (Quick Assessment) --------------------
// NOTE: Use ONLY the Project URL + Publishable (anon) key.
const SUPABASE_URL = "https://tcofqcoeqptjdjawgohb.supabase.co";
const SUPABASE_ANON_KEY = "sb_publishable_3ud-FlpJ9AZZDIzVkZ1EoA_B7c-Vs7B";
const RESULTS_TABLE = "quiz_attempts"; // change this if your table name differs

const supabaseClient = (window.supabase && SUPABASE_URL && SUPABASE_ANON_KEY)
  ? window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY)
  : null;

function getAttemptId(){
  if(S && S.attemptId) return S.attemptId;
  const id = (window.crypto && crypto.randomUUID)
    ? crypto.randomUUID()
    : (String(Date.now()) + "_" + Math.random().toString(16).slice(2));
  if(S) S.attemptId = id;
  return id;
}

function queuePendingAttempt(payload){
  try{
    const k = KEY + "__pending";
    const arr = JSON.parse(localStorage.getItem(k) || "[]");
    arr.push(payload);
    localStorage.setItem(k, JSON.stringify(arr));
  }catch(e){}
}

async function flushPendingAttempts(){
  if(!supabaseClient) return;
  const k = KEY + "__pending";
  let arr = [];
  try{ arr = JSON.parse(localStorage.getItem(k) || "[]"); }catch(e){ arr = []; }
  if(!Array.isArray(arr) || arr.length === 0) return;

  // Try send oldest first
  const remaining = [];
  for(const p of arr){
    try{
      const { error } = await supabaseClient.from(RESULTS_TABLE).insert([p]);
      if(error) throw error;
    }catch(e){
      remaining.push(p);
    }
  }
  try{ localStorage.setItem(k, JSON.stringify(remaining)); }catch(e){}
}

async function saveAttemptToSupabase(payload){
  if(!supabaseClient){
    queuePendingAttempt(payload);
    return { ok:false, reason:"no_client" };
  }

  try{
    const { error } = await supabaseClient.from(RESULTS_TABLE).insert([payload]);
    if(error) throw error;
    return { ok:true };
  }catch(e){
    // If offline / blocked by RLS / CORS, keep a local queue so nothing is lost.
    console.error("Supabase save failed:", e);
    queuePendingAttempt(payload);
    return { ok:false, reason:"insert_failed" };
  }
}
// --------------------------------------------------------------------
const QZ={courseTitle:"Course: Coding & Robotics",quizTitle:"Quiz: (100 Questions)",attemptTitle:"Attempt: Coding & Robotics MCQ (100 Questions)",instructions:"Rules: Silent work. No talking. Auto-submit when time runs out.",durationMinutes:35,autosaveSeconds:15,requireName:!0,requireClass:!0,showReviewAfterSubmit:!0,questions:[{t:"What is an algorithm?",o:["A computer","A step-by-step set of instructions","A robot","A mistake"],a:1},{t:"A loop is used to‚Ä¶",o:["Repeat instructions","Delete files","Turn off a computer","Open a website"],a:0},{t:"Debugging means‚Ä¶",o:["Finding and fixing mistakes","Making the screen brighter","Charging a laptop","Printing a page"],a:0},{t:"Which is a block-coding tool for learners?",o:["Scratch","PowerPoint","Calculator","Camera"],a:0},{t:"Which comes first when solving a problem?",o:["Plan","Copy","Guess","Skip"],a:0},{t:"What is a program?",o:["A set of instructions for a computer","A type of keyboard","A battery","A monitor"],a:0},{t:"An IF statement is used to‚Ä¶",o:["Make a choice/decision","Print a document","Charge a device","Open the Start menu"],a:0},{t:"Which is an example of a condition?",o:["If score is > 10","Draw a circle","Press spacebar","Open Chrome"],a:0},{t:"Which is an example of output?",o:["Sound from speakers","Mouse click","Keyboard typing","Touchpad tap"],a:0},{t:"Which is an example of input?",o:["Printer page","Monitor picture","Keyboard key press","Speaker sound"],a:2},{t:"What does CPU stand for?",o:["Central Processing Unit","Computer Power Unit","Control Program User","Central Print Unit"],a:0},{t:"A bug in code is a‚Ä¶",o:["Mistake/error","Type of mouse","Good idea","Battery"],a:0},{t:"Why do we test programs?",o:["To find problems","To make them slower","To delete them","To waste time"],a:0},{t:"Which is a good coding habit?",o:["Test often","Never save","Skip instructions","Rush"],a:0},{t:"What does SAVE do?",o:["Stores your work","Deletes your work","Turns off Wi-Fi","Changes the wallpaper"],a:0},{t:"Which is a sequence?",o:["Steps in order","A random guess","A picture","A battery"],a:0},{t:"Which word means 'repeat'?",o:["Loop","Stop","Close","Exit"],a:0},{t:"What is decomposition?",o:["Breaking a big problem into smaller parts","Making a robot faster","Cleaning a laptop","Typing without looking"],a:0},{t:"Pattern recognition means‚Ä¶",o:["Finding things that repeat","Deleting patterns","Printing patterns","Charging patterns"],a:0},{t:"Abstraction means‚Ä¶",o:["Focusing on important details","Adding extra details","Making it confusing","Turning off the screen"],a:0},{t:"Which is an example of an instruction?",o:["Move forward","Blue","Laptop","Triangle"],a:0},{t:"A flowchart is used to‚Ä¶",o:["Show steps of a process","Play music","Charge devices","Take photos"],a:0},{t:"In a flowchart, a diamond usually means‚Ä¶",o:["Decision","Start","End","Data"],a:0},{t:"In a flowchart, a rectangle usually means‚Ä¶",o:["Process/Action","Decision","Start","Arrow"],a:0},{t:"A variable is like a‚Ä¶",o:["Box that stores information","Type of printer","Mouse pointer","Battery"],a:0},{t:"typing.com helps you practise‚Ä¶",o:["Typing","Drawing","Singing","Cooking"],a:0},{t:"Which key starts a new line?",o:["Enter","Shift","Ctrl","Alt"],a:0},{t:"Which key makes a space?",o:["Spacebar","Tab","Caps Lock","Esc"],a:0},{t:"Which key deletes to the LEFT?",o:["Backspace","Delete","Enter","Windows"],a:0},{t:"Which key deletes to the RIGHT?",o:["Delete","Backspace","Shift","Tab"],a:0},{t:"Caps Lock is used to‚Ä¶",o:["Type in capitals","Open a file","Print","Save"],a:0},{t:"Good posture means‚Ä¶",o:["Sit upright","Lie down","Look away","Use one finger"],a:0},{t:"Accuracy means‚Ä¶",o:["Few mistakes","Very loud typing","Only speed","No punctuation"],a:0},{t:"Touch typing means‚Ä¶",o:["Typing without looking at keys","Typing with a touchscreen","Typing slowly","Typing in all caps"],a:0},{t:"Home row includes‚Ä¶",o:["A S D F","Q W E R","Z X C V","1 2 3 4"],a:0},{t:"Which finger often presses the spacebar?",o:["Thumb","Index","Middle","Little"],a:0},{t:"Tab key is often used to‚Ä¶",o:["Move to next field/indent","Turn off laptop","Print","Delete a file"],a:0},{t:"Shift key is used to‚Ä¶",o:["Make capital letters / symbols","Open Start menu","Save","Close"],a:0},{t:"Why should you keep eyes on the screen?",o:["To build touch-typing","To type slower","To make more errors","To waste time"],a:0},{t:"Which is a punctuation mark?",o:[".","7","A","Ctrl"],a:0},{t:"Which key makes a question mark on many keyboards?",o:["Shift + /","Ctrl + ?","Alt + ?","Windows + ?"],a:0},{t:"Typing speed is usually measured in‚Ä¶",o:["WPM","KM","Volts","Pixels"],a:0},{t:"If you make a mistake, you should‚Ä¶",o:["Use Backspace and fix it","Ignore it always","Close the laptop","Unplug the charger"],a:0},{t:"A shortcut is‚Ä¶",o:["A faster way to do something","A kind of mouse","A printer","A battery"],a:0},{t:"Which shortcut saves in many apps?",o:["Ctrl + S","Ctrl + P","Ctrl + C","Ctrl + V"],a:0},{t:"Ctrl + C usually means‚Ä¶",o:["Copy","Cut","Close","Caps"],a:0},{t:"Ctrl + V usually means‚Ä¶",o:["Paste","Print","Pause","Preview"],a:0},{t:"Ctrl + X usually means‚Ä¶",o:["Cut","Copy","Undo","Redo"],a:0},{t:"Ctrl + Z usually means‚Ä¶",o:["Undo","Zoom","Zip","Zero"],a:0},{t:"Ctrl + A usually means‚Ä¶",o:["Select all","Save","Print","Search"],a:0},{t:"Windows is a(n)‚Ä¶",o:["Operating system","Browser","Game","Keyboard"],a:0},{t:"The Windows key usually opens‚Ä¶",o:["Start menu","Camera","Printer","Calculator only"],a:0},{t:"The touchpad controls the‚Ä¶",o:["Pointer/cursor","Speaker","Battery","Keyboard lights"],a:0},{t:"The power button is used to‚Ä¶",o:["Turn device on/off","Type letters","Print","Take photos"],a:0},{t:"Which is safe laptop behaviour?",o:["Keep drinks away","Shake the laptop","Pull the charger to turn off","Hit the keyboard"],a:0},{t:"A file is‚Ä¶",o:["A saved document or item","A type of mouse","A keyboard key","A battery"],a:0},{t:"A folder is used to‚Ä¶",o:["Organise files","Play music","Charge the laptop","Change passwords"],a:0},{t:"Which icon closes a window?",o:["X","‚ñ°","‚Äì","?"],a:0},{t:"Minimise means‚Ä¶",o:["Hide a window to the taskbar","Delete a file","Turn off Wi-Fi","Print"],a:0},{t:"Maximise means‚Ä¶",o:["Make the window full screen","Make it smaller","Delete it","Send it to the printer"],a:0},{t:"Wi-Fi is used to‚Ä¶",o:["Connect to the internet","Charge the battery","Make the screen bigger","Type faster"],a:0},{t:"A browser is used to‚Ä¶",o:["Visit websites","Charge devices","Write with a pen","Build robots"],a:0},{t:"Which is a browser?",o:["Google Chrome","Windows","Keyboard","Touchpad"],a:0},{t:"A password should be‚Ä¶",o:["Kept private","Shared with friends","Written on the desk","Very short"],a:0},{t:"What does \"Ctrl + S\" do?",o:["Save","Search","Stop","Screenshot"],a:0},{t:"What does \"Ctrl + P\" do in many apps?",o:["Print","Paste","Pause","Power off"],a:0},{t:"The taskbar is usually at the‚Ä¶",o:["Bottom of the screen","Top only","Middle","It is invisible"],a:0},{t:"An app is‚Ä¶",o:["A program you use","A cable","A battery","A folder"],a:0},{t:"To shut down properly you should‚Ä¶",o:["Use Shut down option","Pull the plug","Close the lid always","Press random keys"],a:0},{t:"If a laptop is overheating, you should‚Ä¶",o:["Tell the teacher","Cover it with a book","Put it in the sun","Pour water"],a:0},{t:"A screenshot is a‚Ä¶",o:["Picture of the screen","Type of battery","Robot move","Printer file"],a:0},{t:"Which key is often used to switch between open apps?",o:["Alt + Tab","Ctrl + S","Shift + Enter","Windows + P"],a:0},{t:"Volume buttons control‚Ä¶",o:["Sound","Typing speed","Wi-Fi","Battery"],a:0},{t:"Brightness controls‚Ä¶",o:["How light the screen is","How loud it is","How fast Wi-Fi is","How many files"],a:0},{t:"A charger is used to‚Ä¶",o:["Recharge the battery","Print pages","Open websites","Type"],a:0},{t:"Which is hardware?",o:["Keyboard","Windows","Website","Typing.com"],a:0},{t:"Which is software?",o:["Windows","Mouse","Screen","USB cable"],a:0},{t:"A USB port is used to‚Ä¶",o:["Plug in devices","Turn on Wi-Fi","Change wallpaper","Delete files"],a:0},{t:"A mouse pointer is also called a‚Ä¶",o:["Cursor","Battery","Folder","Speaker"],a:0},{t:"Double-click means‚Ä¶",o:["Click twice quickly","Hold the mouse","Press Enter","Turn off"],a:0},{t:"Sphero is a‚Ä¶",o:["Programmable robot ball","Printer","Keyboard","Monitor"],a:0},{t:"Sphero Edu is used to‚Ä¶",o:["Code Sphero","Cook food","Print","Draw"],a:0},{t:"When Sphero moves, it uses‚Ä¶",o:["Motors","Ink","Paper","Keys"],a:0},{t:"A sensor helps a robot‚Ä¶",o:["Detect things","Eat","Sleep","Write"],a:0},{t:"A loop can make Sphero‚Ä¶",o:["Repeat actions","Lose battery instantly","Break","Freeze always"],a:0},{t:"To make Sphero stop, you use‚Ä¶",o:["Stop block","Start menu","Caps Lock","Print"],a:0},{t:"Which is a good robotics skill?",o:["Problem-solving","Guessing","Shouting","Rushing"],a:0},{t:"If Sphero goes the wrong way, you should‚Ä¶",o:["Check the code","Throw it","Ignore it","Unplug Wi-Fi"],a:0},{t:"Robots follow‚Ä¶",o:["Instructions","Feelings","Luck","Noise"],a:0},{t:"What is a safe rule for Sphero use?",o:["Use gently and follow rules","Kick it","Use near water","Throw at friends"],a:0},{t:"A variable in coding is like a‚Ä¶",o:["Box for information","Keyboard","Printer","Battery"],a:0},{t:"An event in coding is‚Ä¶",o:["Something that triggers an action","A folder","A cable","A charger"],a:0},{t:"Which command would best change Sphero colour?",o:["Set colour","Shut down","Print","Save"],a:0},{t:"A program for Sphero can include‚Ä¶",o:["Move and turn","Cook","Paint walls","Wash"],a:0},{t:"If a robot is not connecting, you might check‚Ä¶",o:["Bluetooth","Pencil","Ruler","Glue"],a:0},{t:"Bluetooth is used for‚Ä¶",o:["Short-range wireless connection","Printing","Charging","Typing"],a:0},{t:"To make Sphero go faster you can‚Ä¶",o:["Increase speed value","Press Caps Lock","Change wallpaper","Print"],a:0},{t:"To make Sphero turn, you can change‚Ä¶",o:["Direction/heading","Font size","Battery type","Browser"],a:0},{t:"Robotics helps you learn‚Ä¶",o:["Logic","Only drawing","Only singing","Only sport"],a:0},{t:"In robotics, 'trial and error' means‚Ä¶",o:["Try, test, improve","Give up","Copy only","Never test"],a:0}]};
const $=id=>document.getElementById(id),KEY="disa_quiz_100q_v2";
// Keep an immutable copy of questions so reshuffles are stable
const ORIGINAL_QUESTIONS = JSON.parse(JSON.stringify(QZ.questions));
function restoreQuestions(){ QZ.questions = JSON.parse(JSON.stringify(ORIGINAL_QUESTIONS)); }
let S={c:0,r:QZ.durationMinutes*60,A:{},F:{},L:!1,seed:null},T=null;const esc=s=>String(s).replace(/[&<>\"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"}[m]));
function selfTest(){if(!Array.isArray(QZ.questions)||QZ.questions.length!==100)throw Error("Questions must be 100");if(!QZ.questions.every(q=>q&&Array.isArray(q.o)&&q.o.length===4&&Number.isInteger(q.a)&&q.a>=0&&q.a<4))throw Error("Question format invalid");}
function nav(){const h=$("navGrid");h.innerHTML="";for(let i=0;i<QZ.questions.length;i++){const b=document.createElement("button");b.className="qbtn todo";b.textContent=i+1;b.type="button";b.addEventListener("click",()=>{if(S.L)return;S.c=i;ren();navUI();});h.appendChild(b);}}
function ren(){const q=QZ.questions[S.c],sel=S.A[S.c],fl=!!S.F[S.c];$("qcard").innerHTML=`<div class="qhead"><div><div class="qnum">Question ${S.c+1} of ${QZ.questions.length}</div><div class="qtext">${esc(q.t)}</div></div><div class="qpts">1 mark</div></div><div class="qbody">${q.o.map((o,idx)=>{const id=`q_${S.c}_opt_${idx}`;return `<label class="opt" for="${id}"><input ${(sel===idx)?"checked":""} ${S.L?"disabled":""} type="radio" id="${id}" name="q_${S.c}" value="${idx}"/><span>${esc(o)}</span></label>`}).join("")}</div>`;const fb=$("flagBtn");fb.classList.toggle("flagged",fl);fb.textContent=fl?"‚öë Flagged":"‚öë Flag question";$("prevBtn").disabled=S.L||S.c===0;$("nextBtn").disabled=S.L||S.c===QZ.questions.length-1;}
function navUI(){const bs=Array.from($("navGrid").children);for(let i=0;i<bs.length;i++){const b=bs[i];b.classList.remove("todo","done","flag","current");(S.A[i]!==void 0?b.classList.add("done"):b.classList.add("todo"));if(S.F[i])b.classList.add("flag");if(i===S.c)b.classList.add("current");b.disabled=S.L;}$("learnerName").disabled=S.L;$("className").disabled=S.L;const sb=$("submitBtn");if(sb){sb.textContent=S.L?"Submitted":"Submit all and finish";sb.disabled=!1;}}
const un=()=>{let n=0;for(let i=0;i<QZ.questions.length;i++)S.A[i]===void 0&&n++;return n;};
function idOK(){const n=$("learnerName").value.trim(),c=$("className").value.trim();if(QZ.requireName&&!n){alert("Please enter your name.");$("learnerName").focus();return!1}if(QZ.requireClass&&!c){alert("Please enter your class (e.g., 7B).");$("className").focus();return!1}return!0}
function score(){let e=0;const br=[];for(let i=0;i<QZ.questions.length;i++){const q=QZ.questions[i],sel=S.A[i],ok=sel===q.a;e+=ok?1:0;br.push([i,ok,sel,q.a]);}return{e,t:QZ.questions.length,br}}
// --- seeded shuffle (stops correct answers being mostly option A) ---
function hashStr(str){let h=2166136261>>>0;for(let i=0;i<str.length;i++){h^=str.charCodeAt(i);h=Math.imul(h,16777619);}return h>>>0;}
function mulberry32(a){return function(){let t=a+=0x6D2B79F5;t=Math.imul(t^t>>>15,t|1);t^=t+Math.imul(t^t>>>7,t|61);return((t^t>>>14)>>>0)/4294967296;};}
function shuffleInPlace(arr,rng){for(let i=arr.length-1;i>0;i--){const j=Math.floor(rng()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}}
function ensureSeed(){
  if(S.seed!=null) return;
  const n=$("learnerName").value.trim();
  const c=$("className").value.trim();
  const base=(n&&c)?(n+"|"+c):("anon");
  S.seed=hashStr(base+"|"+KEY);
}
function shuffleOptionsDeterministic(){
  ensureSeed();
  const rng=mulberry32(S.seed);
  for(const q of QZ.questions){
const tagged=q.o.map((text,idx)=>({text,idx}));shuffleInPlace(tagged,rng);q.o=tagged.map(x=>x.text);q.a=tagged.findIndex(x=>x.idx===q.a);} }
// ---------------------------------------------------------------
// celebrations
const rnd=(a,b)=>a+Math.random()*(b-a);
function showToast({e,t,pct,auto,perfect,name,cls}){const box=$("toastBox");if(!box)return;box.innerHTML="";const pass=pct>=50;const toast=document.createElement("div");toast.className="toast toast-enter";const emoji=perfect?"üèÜ":(pass?"‚úÖ":"üß†");const status=perfect?"PERFECT!":(pass?"PASS":"NOT YET");const ident=(!auto&&(name||cls))?`<div class="tMeta" style="margin-top:2px"><strong>${esc(name||"")}</strong>${cls?` <span style="opacity:.6">‚Ä¢</span> <strong>${esc(cls)}</strong>`:""}</div>`:"";
toast.innerHTML=`<div class="emoji">${emoji}</div><div style="flex:1;min-width:0"><div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap"><p class="tTitle" style="margin:0">Quiz submitted</p><span class="pill ${pass?"ok":"bad"}">${status}</span></div>${ident}<p class="tMeta">${auto?"Time is up ‚Äî your attempt was auto-submitted.":"Submitted successfully."}</p><div class="tScore">Score: <strong>${e}/${t}</strong> ‚Ä¢ <strong>${pct}%</strong></div>${perfect?"":`<div class="tMeta" style="margin-top:6px">Try again to improve your mark!</div>`}</div><button class="ghost" id="toastClose" style="margin-left:auto">Close</button>`;box.appendChild(toast);const btn=toast.querySelector('#toastClose');btn&&btn.addEventListener('click',()=>{toast.classList.add('toast-blur-exit');setTimeout(()=>toast.remove(),350);});}
function confettiBurst(){const cl=$("confettiLayer");if(!cl)return;cl.innerHTML="";const n=140;for(let i=0;i<n;i++){const p=document.createElement("div");p.className="confettiPiece";p.style.left=rnd(0,100)+"vw";p.style.setProperty("--delay",rnd(0,0.6)+"s");p.style.setProperty("--dur",rnd(2.8,4.2)+"s");p.style.background=["#b11226","#ffd24a","#1b7f3b","#0b2d4c","#ffffff"][i%5];p.style.width=rnd(7,12)+"px";p.style.height=rnd(10,18)+"px";cl.appendChild(p);}setTimeout(()=>{cl.innerHTML="";},5200);}
function fireworksShow(ms=10000){const ov=$("fxOverlay"),cv=$("fxCanvas"),cg=$("congrats");if(!ov||!cv)return;ov.classList.add("show");ov.setAttribute("aria-hidden","false");cg&&cg.classList.add("rise");const ctx=cv.getContext("2d");let w=0,h=0;const dpr=Math.max(1,Math.min(2,window.devicePixelRatio||1));const resize=()=>{w=ov.clientWidth;h=ov.clientHeight;cv.width=Math.floor(w*dpr);cv.height=Math.floor(h*dpr);cv.style.width=w+"px";cv.style.height=h+"px";ctx.setTransform(dpr,0,0,dpr,0,0);};resize();window.addEventListener("resize",resize,{passive:true});let parts=[];const makeBurst=()=>{const x=rnd(w*0.15,w*0.85),y=rnd(h*0.12,h*0.45);const count=46;const base=["#ffd24a","#ff6b6b","#6bcBef","#a29bfe","#55efc4","#ffffff"];for(let i=0;i<count;i++){const ang=rnd(0,Math.PI*2),spd=rnd(1.2,4.2),life=rnd(40,90);parts.push({x,y,vx:Math.cos(ang)*spd,vy:Math.sin(ang)*spd,life,max:life,c:base[(i+Math.floor(rnd(0,6)))%base.length],r:rnd(1.2,2.6)});}};let last=0,acc=0;let running=true;const step=(ts)=>{if(!last)last=ts;const dt=Math.min(32,ts-last);last=ts;acc+=dt;ctx.clearRect(0,0,w,h);ctx.fillStyle="rgba(0,0,0,.14)";ctx.fillRect(0,0,w,h);for(let i=parts.length-1;i>=0;i--){const p=parts[i];p.life-=dt/16;p.vy+=0.06;p.x+=p.vx;p.y+=p.vy;const k=p.life/p.max;if(k<=0||p.y>h+40||p.x<-40||p.x>w+40){parts.splice(i,1);continue;}ctx.globalAlpha=Math.max(0,k);ctx.beginPath();ctx.fillStyle=p.c;ctx.arc(p.x,p.y,p.r,0,Math.PI*2);ctx.fill();}ctx.globalAlpha=1;if(acc>520){acc=0;makeBurst();}if(running)requestAnimationFrame(step);};makeBurst();makeBurst();requestAnimationFrame(step);setTimeout(()=>{running=false;window.removeEventListener("resize",resize);ov.classList.remove("show");ov.setAttribute("aria-hidden","true");cg&&cg.classList.remove("rise");ctx&&ctx.clearRect(0,0,w,h);},ms);}
function celebrate({e,t,pct,auto,name,cls}){const perfect=pct===100;confettiBurst();showToast({e,t,pct,auto,perfect,name,cls});if(perfect)setTimeout(()=>fireworksShow(10000),300);} 
function save(extra={}){localStorage.setItem(KEY,JSON.stringify({i:{n:$("learnerName").value.trim(),c:$("className").value.trim()},s:{c:S.c,r:S.r,A:S.A,F:S.F,L:S.L,seed:S.seed},x:extra}));}
function load(){const raw=localStorage.getItem(KEY);if(!raw)return;try{const d=JSON.parse(raw);if(d.i){d.i.n&&($("learnerName").value=d.i.n);d.i.c&&($("className").value=d.i.c);}if(d.s){S.c=Number.isFinite(d.s.c)?d.s.c:0;S.r=Number.isFinite(d.s.r)?d.s.r:S.r;S.A=d.s.A||{};S.F=d.s.F||{};S.L=!!d.s.L;S.seed=d.s.seed??S.seed;}if(S.L){stop();}}catch(e){}}
const stop=()=>{T&&(clearInterval(T),T=null)};
function tUI(){const m=String(Math.floor(S.r/60)).padStart(2,"0"),s=String(S.r%60).padStart(2,"0");$("timer").textContent=`${m}:${s}`;const p=$("timerPill");p.classList.remove("warn","danger");S.r<=300&&p.classList.add("warn");S.r<=60&&p.classList.add("danger");}
function start(){
  // Don‚Äôt start timer until learner identity exists (manual or dropdown)
  if(T||S.L) return;
  if(QZ.requireName && !$("learnerName").value.trim()) return;
  if(QZ.requireClass && !$("className").value.trim()) return;
  T=setInterval(()=>{if(S.L)return;S.r=Math.max(0,S.r-1);tUI();S.r%QZ.autosaveSeconds===0&&save({a:1,t:Date.now()});S.r===0&&submit(!0);},1e3)}
function reset(){try{localStorage.removeItem(KEY)}catch(e){}stop();S={c:0,r:QZ.durationMinutes*60,A:{},F:{},L:!1,seed:null};$("learnerName").value="";$("className").value="";$("result").style.display="none";$("result").innerHTML="";$("toastBox").innerHTML="";$("confettiLayer").innerHTML="";nav();ren();navUI();tUI();start();save({r:1,t:Date.now()});}
async function submit(auto=!1){if(S.L||!idOK())return;S.L=!0;stop();navUI();ren();const {e,t,br}=score(),pct=Math.round(e/t*100),pass=pct>=50,name=$("learnerName").value.trim(),cls=$("className").value.trim();

// Best-effort: save score online (and queue locally if it fails)
// Requires your Supabase table + RLS policy to allow INSERT for anon.
const payload={
  attempt_id: getAttemptId(),
  quiz_key: KEY,
  learner_name: name,
  class_name: cls,
  score: e,
  total: t,
  percent: pct,
  auto_submitted: !!auto,
  answers: S.A,
  flagged: S.F,
  duration_minutes: QZ.durationMinutes
};

// Try flush any older queued attempts first, then save this one.
try{ await flushPendingAttempts(); }catch(e){}
saveAttemptToSupabase(payload); // don't block UI/celebrations
celebrate({e,t,pct,auto,name,cls});let html=`<div class="score"><div><div class="big">${esc(name)} (${esc(cls)}) ‚Äî ${e}/${t} ‚Ä¢ ${pct}%</div><div class="small">${auto?"Auto-submitted when time ended.":"Submitted."}</div></div><div class="badge ${pass?"ok":"bad"}">${pass?"PASS":"NOT YET"}</div></div>`;if(QZ.showReviewAfterSubmit){html+=`<details class="review" open><summary>Review answers</summary><ol class="review-list">${br.map(b=>{const i=b[0],ok=b[1],sel=b[2],cor=b[3],q=QZ.questions[i],your=sel===void 0?"No answer":q.o[sel],ca=q.o[cor];return `<li><div><strong>${esc(q.t)}</strong> <span class="${ok?"correct":"wrong"}">(${ok?"Correct":"Incorrect"})</span></div><div>Your a: ${esc(String(your))}</div>${ok?"":`<div>Correct a: <span class="correct">${esc(String(ca))}</span></div>`}</li>`}).join("")}</ol></details>`;}
$("result").innerHTML=html;$("result").style.display="block";save({s:1,p:pct,t:Date.now(),auto});$("result").scrollIntoView({behavior:"smooth",block:"start"});}
function bind(){document.addEventListener("change",e=>{if(S.L)return;const t=e.target;if(t&&t.matches('input[type="radio"][name^="q_"]')){const qi=+t.name.split("_")[1];S.A[qi]=+t.value;navUI();}});$("prevBtn").addEventListener("click",()=>{if(S.L||S.c===0)return;S.c--;ren();navUI();});$("nextBtn").addEventListener("click",()=>{if(S.L||S.c===QZ.questions.length-1)return;S.c++;ren();navUI();});$("flagBtn").addEventListener("click",()=>{if(S.L)return;S.F[S.c]=!S.F[S.c];ren();navUI();});$("submitBtn").addEventListener("click",e=>{e.preventDefault();e.stopPropagation();if(S.L)return;submit(!1);});$("submitBtn").onclick=(e)=>{e&&e.preventDefault&&e.preventDefault();if(S.L)return!1;submit(!1);return!1;};$("finishAttemptBtn").addEventListener("click",()=>{if(S.L)return;const u=un(),fl=Object.values(S.F).filter(Boolean).length;alert(`Finish attempt\n\nUnanswered: ${u}\nFlagged: ${fl}\n\nClick ‚ÄúSubmit all and finish‚Äù to submit.`);});$("saveBtn").addEventListener("click",()=>{if(S.L)return;save({m:1,t:Date.now()});alert("Saved on this device.");});$("resetBtn").addEventListener("click",reset);$("learnerName").addEventListener("input",()=>{S.L||save({ty:1});});$("className").addEventListener("input",()=>{S.L||save({ty:1});});}
async function init(){
  try{
    $("courseTitle").textContent=QZ.courseTitle;
    $("quizTitle").textContent=QZ.quizTitle;
    $("mainTitle").textContent=QZ.attemptTitle;
    $("mainSub").textContent=QZ.instructions;
    selfTest();

    // Supabase dropdown setup (non-blocking)
    loadSupabase();
    if(supabaseClient){
      learnerRows = await fetchLearners();
      populateSelectors(learnerRows);
    }

    load();
    restoreQuestions();
    shuffleOptionsDeterministic();
    nav();
    ren();
    bind();
    tUI();
    navUI();
    start();
  }catch(e){console.error(e);const c=$("qcard");c&&(c.innerHTML='<div class="qhead"><div><div class="qnum">Teacher note: Quiz failed to load</div><div class="qtext">A script error stopped the quiz from showing questions.</div></div><div class="qpts">Fix required</div></div><div class="qbody"><p class="small" style="margin:0">Open DevTools ‚Üí Console to see the error.</p></div>');}}
window.addEventListener("DOMContentLoaded",init);
// Attempt to flush queued attempts when the browser comes back online
window.addEventListener("online",()=>{flushPendingAttempts();});
window.__qz_submit=(auto)=>submit(!!auto);window.__qz_reset=()=>reset();window.__qz_state=()=>({locked:S.L,answered:Object.keys(S.A).length,remaining:S.r});})();</script>
<!-- Supabase JS (v2) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</body></html>
